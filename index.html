<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LOL è§£ç¦ / ç”³è¿°å€’è®¡æ—¶</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen">

  <!-- é¡µå¤´ -->
  <header class="bg-gradient-to-r from-yellow-400 to-orange-400 text-white p-5 text-center shadow">
    <h1 class="text-2xl font-bold">è‹±é›„è”ç›Ÿ è§£ç¦ / ç”³è¿°æ—¶é—´ç®¡ç†</h1>
    <p class="mt-2 text-sm opacity-90">å…¬å¹³æ¸¸æˆï¼Œæ‰èƒ½è®©èƒœåˆ©æ›´æœ‰æ„ä¹‰ ğŸ®</p>
  </header>

  <main class="max-w-5xl mx-auto p-4">

    <!-- æ·»åŠ è¡¨å• -->
    <section class="bg-white rounded-xl shadow p-4 mb-6">
      <h2 class="font-semibold mb-3">æ·»åŠ è®°å½•</h2>
      <form id="addForm" class="grid grid-cols-1 md:grid-cols-4 gap-3">
        <input required id="name" placeholder="è´¦å· / æ˜µç§°" class="border p-2 rounded" />
        <input required id="date" type="datetime-local" class="border p-2 rounded" />
        <select id="type" class="border p-2 rounded">
          <option value="è§£ç¦">è§£ç¦</option>
          <option value="ç”³è¿°">ç”³è¿°</option>
        </select>
        <button class="bg-blue-500 text-white rounded p-2 hover:bg-blue-600">æ·»åŠ </button>
      </form>
    </section>

    <!-- æœç´¢ -->
    <div class="mb-4">
      <input id="search" placeholder="æœç´¢è´¦å· / æ˜µç§°" class="w-full border p-2 rounded" />
    </div>

    <!-- æ•°æ®åˆ—è¡¨ -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="list"></div>

  </main>

<script>
let data = JSON.parse(localStorage.getItem('lolData') || '[]');

const list = document.getElementById('list');
const form = document.getElementById('addForm');
const search = document.getElementById('search');

function save() {
  localStorage.setItem('lolData', JSON.stringify(data));
}

function diffText(target) {
  const now = new Date();
  const diff = target - now;
  if (diff <= 0) return 'å·²åˆ°æœŸ';
  const d = Math.floor(diff / 86400000);
  const h = Math.floor(diff % 86400000 / 3600000);
  const m = Math.floor(diff % 3600000 / 60000);
  const s = Math.floor(diff % 60000 / 1000);
  return `${d}å¤© ${h}å°æ—¶ ${m}åˆ† ${s}ç§’`;
}

function render() {
  list.innerHTML = '';
  const keyword = search.value.toLowerCase();

  data.filter(i => i.name.toLowerCase().includes(keyword)).forEach((item, index) => {
    const target = new Date(item.date);
    const diff = target - new Date();
    const danger = diff < 7 * 86400000 && diff > 0;

    const card = document.createElement('div');
    card.className = `rounded-xl shadow p-4 bg-white border-l-8 ${item.type === 'è§£ç¦' ? 'border-green-400' : 'border-purple-400'}`;

    card.innerHTML = `
      <div class="flex justify-between items-start">
        <div>
          <h3 class="font-bold text-lg">${item.name}</h3>
          <p class="text-sm text-gray-500">${item.type}</p>
        </div>
        <button onclick="removeItem(${index})" class="text-red-500 text-sm">åˆ é™¤</button>
      </div>
      <p class="mt-2 text-sm">åˆ°æœŸæ—¶é—´ï¼š${target.toLocaleString()}</p>
      <p class="mt-3 font-mono text-lg ${danger ? 'text-red-500 animate-pulse' : 'text-blue-600'}">${diffText(target)}</p>
    `;

    list.appendChild(card);
  });
}

function removeItem(index) {
  if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡è®°å½•å—ï¼Ÿ')) {
    data.splice(index, 1);
    save();
    render();
  }
}

form.onsubmit = e => {
  e.preventDefault();
  data.push({
    name: name.value.trim(),
    date: date.value,
    type: type.value
  });
  save();
  form.reset();
  render();
};

search.oninput = render;

setInterval(render, 1000);
render();
</script>

</body>
</html>
